<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard | LMS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin: 0; font-family: 'Segoe UI', Roboto, Arial, sans-serif; background: #f5f7fb; color: #202124;">

<div style="height: 70px; background: #fff; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; padding: 0 40px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
    <div style="display: flex; align-items: center; gap: 20px;">
        <div style="font-size: 1.4rem; font-weight: 800; color: #1a73e8; letter-spacing: -0.5px;">STUDENT LMS</div>
        <a href="{% url 'home' %}" style="text-decoration: none; color: #202124; font-size: 0.9rem; font-weight: 500; padding: 8px 12px; border-radius: 6px; transition: background 0.2s;" onmouseover="this.style.background='#f0f2f5'" onmouseout="this.style.background='transparent'">üè† Home</a>
    </div>

    <div style="display: flex; align-items: center; gap: 20px; font-size: 0.9rem;">
        <span>Welcome, <strong style="color: #1a73e8;">{{ user.username }}</strong></span>
        <a href="{% url 'logout' %}" style="color: #d93025; text-decoration: none; font-weight: 600; border: 1px solid #fad2cf; padding: 6px 14px; border-radius: 6px; background: #fff;">Logout</a>
    </div>
</div>

<div style="max-width: 1200px; margin: 40px auto; padding: 0 20px;">

    <h1 style="margin: 0; font-size: 1.8rem; font-weight: 700;">Dashboard</h1>
    <p style="color: #6b7280; margin-top: 6px; font-size: 1rem;">Manage your courses, notes and leave requests</p>

    <h2 style="margin-top: 40px; font-size: 1.3rem; color: #374151;">Available Courses</h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
        {% for course in available_courses %}
        <div style="background: #ffffff; border-radius: 12px; padding: 24px; border: 1px solid #e5e7eb; box-shadow: 0 2px 6px rgba(0,0,0,0.04); display: flex; flex-direction: column; justify-content: space-between;">
            <div>
                <h3 style="margin: 0 0 10px 0; font-size: 1.1rem; color: #111827;">{{ course.title }}</h3>
                <p style="color: #6b7280; font-size: 0.9rem; line-height: 1.5; margin-bottom: 20px;">
                    {{ course.description|truncatechars:90 }}
                </p>
            </div>
            <a href="{% url 'enroll' course.id %}" style="display: inline-block; background: #1a73e8; color: #fff; padding: 10px 16px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.85rem; text-align: center;">Enroll Now</a>
        </div>
        {% empty %}
        <p style="color: #6b7280; grid-column: 1/-1;">No courses available right now.</p>
        {% endfor %}
    </div>

    <h3 style="margin-top: 3.5rem; font-size: 1.3rem; color: #374151;">My Notes</h3>

    <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden; margin-top: 15px;">
        <table style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead style="background: #f8f9fa; border-bottom: 1px solid #e5e7eb;">
                <tr>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700;">Title</th>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700;">Course</th>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700;">Actions</th>
                </tr>
            </thead>
            <tbody style="color: #374151;">
                {% for note in notes %}
                <tr style="border-bottom: 1px solid #f3f4f6;">
                    <td style="padding: 16px 20px; font-size: 0.95rem; font-weight: 500;">{{ note.title }}</td>
                    <td style="padding: 16px 20px; font-size: 0.9rem;">
                        <span style="background: #eff6ff; color: #1e40af; padding: 4px 10px; border-radius: 6px; font-size: 0.8rem; font-weight: 500;">{{ note.course.title }}</span>
                    </td>
                    <td style="padding: 16px 20px; font-size: 0.9rem;">
                        <a href="{% url 'edit_note' note.id %}" style="color: #1a73e8; text-decoration: none; font-weight: 600; margin-right: 15px;">Edit</a>
                        <a href="{% url 'delete_note' note.id %}" style="color: #d93025; text-decoration: none; font-weight: 600;">Delete</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="text-align: center; padding: 40px; color: #6b7280;">No notes added yet. <a href="{% url 'add_note' %}" style="color: #1a73e8; font-weight: 600;">Create your first note</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 4rem; margin-bottom: 20px;">
        <h2 style="margin: 0; font-size: 1.3rem; color: #374151;">Leave Requests</h2>
        <a href="{% url 'apply_leave' %}" style="background: #111827; color: #fff; padding: 10px 18px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.85rem;">+ Apply Leave</a>
    </div>

    <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead style="background: #f8f9fa; border-bottom: 1px solid #e5e7eb;">
                <tr>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700;">Duration</th>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700;">Reason</th>
                    <th style="padding: 14px 20px; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; font-weight: 700; text-align: center;">Status</th>
                </tr>
            </thead>
            <tbody style="color: #374151;">
                {% for leave in leaves %}
                <tr style="border-bottom: 1px solid #f3f4f6;">
                    <td style="padding: 16px 20px; font-size: 0.9rem; font-weight: 500;">{{ leave.from_date }} <span style="color: #9ca3af;">‚Üí</span> {{ leave.to_date }}</td>
                    <td style="padding: 16px 20px; font-size: 0.9rem; color: #4b5563;">{{ leave.reason }}</td>
                    <td style="padding: 16px 20px; text-align: center;">
                        {% if leave.status == 'APPROVED' %}
                            <span style="background: #e6f4ea; color: #137333; padding: 6px 14px; border-radius: 999px; font-size: 0.75rem; font-weight: 700;">APPROVED</span>
                        {% elif leave.status == 'REJECTED' %}
                            <span style="background: #fce8e6; color: #a50e0e; padding: 6px 14px; border-radius: 999px; font-size: 0.75rem; font-weight: 700;">REJECTED</span>
                        {% else %}
                            <span style="background: #fef7e0; color: #b06000; padding: 6px 14px; border-radius: 999px; font-size: 0.75rem; font-weight: 700;">PENDING</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="text-align: center; padding: 40px; color: #6b7280;">No leave requests found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

</div>

<div style="margin-top: 60px; padding: 30px; text-align: center; color: #9ca3af; font-size: 0.85rem; border-top: 1px solid #e5e7eb;">
    &copy; 2026 Student Learning Management System
</div>

</body>
</html>